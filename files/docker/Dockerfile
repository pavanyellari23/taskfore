FROM registry.ustplatforms.com/nginxinc/nginx-unprivileged:latest

ARG PNPO_MOD_NAME
ARG PNPO_MOD_VENDOR
ARG PNPO_MOD_INFO
ARG PNPO_MOD_MAINTAINER
ARG PNPO_MOD_GROUP
ARG PNPO_MOD_VERSION
ARG PNPO_MOD_RELEASE
ARG PNPO_MOD_BUILD_ID
ARG PNPO_MOD_BUILD_URL
ARG PNPO_MOD_BUILD_PROJECT
ARG PNPO_MOD_BUILD_DATE
ARG PNPO_MOD_BUILD_BRANCH
ARG PNPO_MOD_BUILD_COMMIT_SHA_SHORT
ARG PNPO_MOD_BUILD_COMMIT_SHA_FULL

# Set environment variables
ENV PNPO_MOD_NAME=${PNPO_MOD_NAME:-"NA"}
ENV PNPO_MOD_INFO=${PNPO_MOD_INFO:-"NA"}
ENV PNPO_MOD_VENDOR=${PNPO_MOD_VENDOR:-"Platform and Product Office, UST Inc"}
ENV PNPO_MOD_MAINTAINER=${PNPO_MOD_MAINTAINER:-"DevOps Team <PnP.DevOps@ust.com>"}
ENV PNPO_MOD_GROUP=${PNPO_MOD_GROUP:-"com.ust.pnp.revin"}
ENV PNPO_MOD_VERSION=${PNPO_MOD_VERSION:-"NA"}
ENV PNPO_MOD_RELEASE=${PNPO_MOD_RELEASE:-"NA"}
ENV PNPO_MOD_BUILD_ID=${PNPO_MOD_BUILD_ID:-"0"}
ENV PNPO_MOD_BUILD_URL=${PNPO_MOD_BUILD_URL:-"https://gitlab.ustplatforms.com/"}
ENV PNPO_MOD_BUILD_PROJECT=${PNPO_MOD_BUILD_PROJECT:-"NA"}
ENV PNPO_MOD_BUILD_DATE=${PNPO_MOD_BUILD_DATE:-"NA"}
ENV PNPO_MOD_BUILD_BRANCH=${PNPO_MOD_BUILD_BRANCH:-"NA"}
ENV PNPO_MOD_BUILD_COMMIT_SHA_SHORT=${PNPO_MOD_BUILD_COMMIT_SHA_SHORT:-"NA"}
ENV PNPO_MOD_BUILD_COMMIT_SHA_FULL=${PNPO_MOD_BUILD_COMMIT_SHA_FULL:-"NA"}

# Add metadata
LABEL vendor="${PNPO_MOD_VENDOR}"
LABEL maintainer="${PNPO_MOD_MAINTAINER}"
LABEL name="${PNPO_MOD_NAME}"
LABEL description="${PNPO_MOD_INFO}"
LABEL group="${PNPO_MOD_GROUP}"
LABEL version="${PNPO_MOD_VERSION}"
LABEL release="${PNPO_MOD_RELEASE}"
LABEL build.id="${PNPO_MOD_BUILD_ID}"
LABEL build.url="${PNPO_MOD_BUILD_URL}"
LABEL build.project="${PNPO_MOD_BUILD_PROJECT}"
LABEL build.date="${PNPO_MOD_BUILD_DATE}"
LABEL build.branch="${PNPO_MOD_BUILD_BRANCH}"
LABEL build.commit-sha.short="${PNPO_MOD_BUILD_COMMIT_SHA_SHORT}"
LABEL build.commit-sha.full="${PNPO_MOD_BUILD_COMMIT_SHA_FULL}"

COPY dist/ /usr/share/nginx/html/forecasting/

VOLUME /usr/share/nginx/html
VOLUME /var/log/nginx

EXPOSE 8080
